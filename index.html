<!DOCTYPE html>
<html>
<head>
<title>Calm Mind Bot</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background: linear-gradient(to bottom,#fff4e6,#ffe0cc);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

#chatbox{
  width:360px;
  height:520px;
  background:white;
  border-radius:15px;
  box-shadow:0 0 20px rgba(0,0,0,0.2);
  display:flex;
  flex-direction:column;
}

#messages{
  flex:1;
  padding:10px;
  overflow-y:auto;
}

.msg{
  padding:8px;
  margin:6px;
  border-radius:8px;
}

.user{ background:#ffd6b3; }
.bot{ background:#e6ffe6; }

#inputArea{
  display:flex;
  padding:10px;
}

input{
  flex:1;
  padding:8px;
}

button{
  padding:8px;
}
</style>
</head>

<body>

<audio id="music" autoplay loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<div id="chatbox">
  <div id="messages"></div>

  <div id="inputArea">
    <input id="text" placeholder="Type your thoughts..." />
    <button onclick="send()">Send</button>
  </div>
</div>

<script>
const music = document.getElementById("music");

function add(text,cls){
  const div=document.createElement("div");
  div.className="msg "+cls;
  div.innerText=text;
  document.getElementById("messages").appendChild(div);
}

async function send(){
  const input=document.getElementById("text");
  const msg=input.value;
  if(!msg) return;

  add(msg,"user");
  input.value="";

  music.volume=0.2;

  const res=await fetch("/chat",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ message:msg })
  });

  const data=await res.json();

  add(data.reply,"bot");

  speak(data.reply);
  music.volume=1;
}

function speak(text){
  const speech=new SpeechSynthesisUtterance(text);
  speech.rate=0.9;
  speech.pitch=1;
  speech.volume=1;
  speechSynthesis.speak(speech);
}
</script>

</body>
</html>
